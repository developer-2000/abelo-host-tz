# Abelo Host - Тестовое задание

Простой веб-сайт на чистом PHP (без фреймворков) с использованием MySQL и шаблонизатора Smarty. Реализует функционал блога с категориями и постами.

## Технологический стек

- PHP 8.1+
- Шаблонизатор Smarty
- База данных MySQL 8
- Nginx
- Node.js (для компиляции SCSS)

## Быстрый старт

Инструкция по запуску: [INSTALL_PROJECT.md](INSTALL_PROJECT.md)

**При первом запуске docker-compose up --build -d:**
- Загружается схема БД (`database/schema.sql`)
- Запускаются сидеры (`database/seed.php`) для наполнения тестовыми данными

### Запуск

```bash
docker-compose up -d
```

### Остановка

```bash
docker-compose down
```

## Доступ к приложению

- **Основное приложение**: http://localhost
- **phpMyAdmin**: http://localhost:8080

## Структура проекта

```
abelo-host-tz/
├── app/                           # PHP приложение
│   ├── Controllers/              # Контроллеры
│   │   ├── BaseController.php    # Базовый контроллер
│   │   ├── HomeController.php    # Главная страница
│   │   ├── CategoryController.php # Страница категории
│   │   └── PostController.php    # Страница статьи
│   ├── Models/                   # Модели данных
│   │   ├── Category.php          # Модель категорий
│   │   └── Post.php              # Модель статей
│   ├── Services/                 # Бизнес-логика
│   │   ├── CategoryService.php   # Сервис категорий
│   │   ├── PostService.php       # Сервис статей
│   │   ├── PaginationService.php # Сервис пагинации
│   │   └── ValidatorService.php  # Сервис валидации
│   ├── Core/                     # Ядро приложения
│   │   ├── Router.php            # Маршрутизация
│   │   ├── Database.php          # Подключение к БД
│   │   ├── DatabaseConfig.php    # Конфигурация БД
│   │   └── SmartyInit.php        # Инициализация Smarty
│   ├── Http/Requests/            # DTO для запросов
│   │   └── CategoryPageRequest.php
│   ├── Helpers/                  # Вспомогательные классы
│   │   └── PaginationHelper.php  # Хелпер пагинации
│   └── routes/                   # Маршруты
│       └── web.php              # Определение маршрутов
├── public/                       # Публичная директория
│   ├── index.php                # Точка входа
│   └── assets/                  # Статические файлы
│       └── css/                 # Скомпилированный CSS
│           └── main.css
├── templates/                    # Шаблоны Smarty
│   ├── layouts/                 # Базовые шаблоны
│   │   └── main.tpl             # Основной layout
│   ├── pages/                   # Шаблоны страниц
│   │   ├── home.tpl             # Главная страница
│   │   ├── category.tpl        # Страница категории
│   │   ├── post.tpl            # Страница статьи
│   │   └── 404.tpl             # Страница 404
│   └── components/              # Компоненты
│       ├── header.tpl           # Шапка сайта
│       ├── footer.tpl           # Подвал сайта
│       ├── post_card.tpl        # Карточка статьи
│       └── pagination.tpl       # Компонент пагинации
├── database/                     # Работа с БД
│   ├── schema.sql               # Структура БД
│   └── seed.php                 # Сидинги данных
├── assets/                       # Исходные файлы стилей
│   └── scss/                    # SCSS файлы
│       ├── main.scss            # Главный файл
│       ├── _variables.scss      # Переменные
│       ├── layouts/             # Стили layouts
│       │   ├── _header.scss
│       │   └── footer.scss
│       └── components/          # Стили компонентов
│           ├── _post-card.scss
│           ├── _pagination.scss
│           ├── _category.scss
│           ├── _post.scss
│           └── home.scss
├── configs/                      # Конфигурации
│   └── site.conf                # Конфигурация Smarty
├── var/                          # Кэш и временные файлы
│   ├── templates_c/             # Скомпилированные шаблоны Smarty
│   └── cache/                   # Кэш Smarty
├── docker/                       # Docker конфигурации
│   ├── nginx/                   # Конфигурация Nginx
│   │   └── default.conf
│   └── php/                     # Конфигурация PHP
│       ├── entrypoint.sh        # Скрипт запуска
│       ├── php.ini              # Настройки PHP
│       └── www.conf             # Конфигурация PHP-FPM
├── docker-compose.yml            # Docker Compose конфигурация
├── Dockerfile                    # Образ PHP
├── composer.json                 # Зависимости PHP
├── package.json                  # Зависимости Node.js
├── README.md                     # Документация
├── INSTALL_PROJECT.md            # Инструкция по установке
└── .env                          # Переменные окружения
```

## Техническое задание

### Требования

Разработать простой, но полностью рабочий веб-сайт на чистом PHP (без фреймворков) с использованием MySQL и шаблонизатора Smarty. Сайт должен реализовывать функционал блога с категориями и постами.

**Технологический стек:**
- PHP 8.1+
- Шаблонизатор Smarty
- База данных MySQL
- Без использования фреймворков

**Структура данных:**
- **Категория**: название, описание
- **Статья**: изображение, название, описание, текст, категория (одна или несколько), количество просмотров

### Обязательные страницы

#### Главная страница
- Вывести каждую категорию, в которой есть статьи
- Отобразить 3 последних поста (по дате публикации) для каждой категории
- Вывести кнопку "Все статьи" для каждой категории

#### Страница категории
- Вывести название и описание категории
- Список статей категории
- Реализовать сортировку статей:
  - По количеству просмотров
  - По дате публикации
- Реализовать пагинацию

#### Страница статьи
- Вывести всю информацию о статье (изображение, название, описание, текст, категории, просмотры, дата)
- Вывести блок из 3 похожих статей (из тех же категорий)
- Увеличивать счётчик просмотров при открытии статьи

### Дополнительный функционал
- Реализовать функционал для сидинга категорий и статей (наполнение тестовыми данными)

## Реализация

### Архитектура проекта

Проект реализован с использованием паттерна MVC и принципов SOLID:

- **Controllers** (`app/Controllers/`) - тонкие контроллеры, делегируют логику сервисам
- **Models** (`app/Models/`) - работа с базой данных через PDO
- **Services** (`app/Services/`) - бизнес-логика приложения
- **Core** (`app/Core/`) - ядро приложения (Router, Database, SmartyInit)
- **Templates** (`templates/`) - шаблоны Smarty с компонентным подходом

### Реализованные функции

✅ **Главная страница** (`HomeController`)
- Получение категорий с последними 3 постами через `CategoryService`
- Сортировка постов по дате публикации (DESC)
- Отображение кнопки "Все статьи категории"

✅ **Страница категории** (`CategoryController`)
- Валидация параметров через DTO (`CategoryPageRequest`)
- Сортировка по дате или просмотрам
- Пагинация с выбором количества постов на странице (3, 6, 9, 12, 15)
- Универсальный компонент пагинации с функцией генерации ссылок

✅ **Страница статьи** (`PostController`)
- Отображение полной информации о статье
- Автоматическое увеличение счётчика просмотров
- Поиск похожих статей из тех же категорий (до 3 штук)

✅ **Сидинг данных** (`database/seed.php`)
- Автоматическое создание 10 категорий
- Автоматическое создание 50 статей
- Связывание статей с категориями (1-3 категории на статью)
- Использование placeholder-сервиса для изображений (picsum.photos)
- Автоматический запуск при первом развертывании

### Безопасность

- Все SQL-запросы используют prepared statements (PDO)
- Все данные экранируются в шаблонах через `|escape`
- Валидация всех входных параметров (id, page, sort, perPage)
- Обработка граничных случаев (404 для несуществующих записей)

### Дополнительные улучшения

- Использование SCSS для стилей с модульной структурой
- Docker-окружение для быстрого развертывания
- Централизованная конфигурация БД (`DatabaseConfig`)
- Базовый контроллер (`BaseController`) для общей логики
- Сервис пагинации (`PaginationService`) для переиспользования
- DTO для валидации запросов (`CategoryPageRequest`)
- PHPDoc комментарии для документации кода




